# SAST-TimeTable-Poster

## 简介

这是一个用来批量生成课程表的工具，用飞书 API 从日历中获取课程信息，并支持自定义修改课程信息后，用于生成课程表图片。

## 使用方法

安装 python 依赖

```bash
pip install -r requirements.txt
```

配置 info.json 文件，内容如下。联系软研开放使用权限，并获取详细 info.json 文件，并放入项目根目录下

```json
{
    "client_id": "你的Client ID",
    "client_secret": "你的Client Secret",
    "calendar_id": "课程表日历ID"
}
```

运行 main.py

```bash
python main.py
```

脚本需要手动授权飞书账号权限，如遇到权限使用问题，请联系软研获取帮助。

授权成功后，脚本会从 SAST 公开日历中获取课程信息，并进入交互式界面，允许你修改课程的标题、地点和部门等信息。

需要确保的是课程标题应符合如下格式`[部门] [组别] [课程名称]`，可以通过该正则匹配`^\s*[^\s]+\s+[^\s]+\s+[\s\S]+$`，例如`软件研发部 Python组 Python编程入门`

**如果不符合该格式，脚本会提示你修改标题。同时注意课程名称不要过长**

交互界面中的操作说明如下：

| 键位        | 功能     |
| ----------- | -------- |
| ↑↓          | 选择操作 |
| Enter/Space | 确认操作 |
| Tab         | 切换按钮 |

最终生成的课程表图片会保存在同文件夹的 output 目录下
